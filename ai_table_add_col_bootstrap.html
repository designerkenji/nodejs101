<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table with Toggle State Icon</title>
    <!-- Include Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <style>
        th {
            cursor: pointer;
        }
        .toggle-icon {
            font-size: 20px;
            margin-right: 5px;
        }
    </style>
</head>
<body class="container">

<h2 class="mt-4">Dynamic Table with Bootstrap</h2>

<table id="myTable" class="table table-bordered table-hover">
    <thead>
        <!-- The header row will be generated by JavaScript -->
    </thead>
    <tbody>
        <!-- Rows will be dynamically populated from the tableData array -->
    </tbody>
</table>

<button class="btn btn-primary mt-3" onclick="addColumnToArray()">Add Column</button>

<script>
    // Initialize a variable to keep track of the toggle state
    let rowsVisible = false;

    // Initialize a two-dimensional array with 15 rows and 3 columns, including column headers
    let tableData = [
        ['Column 1', 'Column 2', 'Column 3'],
        ['<span id="toggleIcon" class="toggle-icon">+</span> Row 1, Cell 1', 'Row 1, Cell 2', 'Row 1, Cell 3'],
        ['Row 2, Cell 1', 'Row 2, Cell 2', 'Row 2, Cell 3'],
        ['Row 3, Cell 1', 'Row 3, Cell 2', 'Row 3, Cell 3'],
        ['Row 4, Cell 1', 'Row 4, Cell 2', 'Row 4, Cell 3'],
        // Add remaining rows here...
        ['Row 15, Cell 1', 'Row 15, Cell 2', 'Row 15, Cell 3']
    ];

    // Function to populate the table from the array
    function populateTableFromArray() {
        const table = document.getElementById('myTable');
        const thead = table.querySelector('thead');
        const tbody = table.querySelector('tbody');

        // Clear existing table rows
        thead.innerHTML = '';
        tbody.innerHTML = '';

        // Populate the header row
        const headerRow = document.createElement('tr');
        for (let i = 0; i < tableData[0].length; i++) {
            const headerCell = document.createElement('th');
            headerCell.innerHTML = tableData[0][i];
            headerCell.onclick = function() { deleteColumn(i); };
            headerRow.appendChild(headerCell);
        }
        thead.appendChild(headerRow);

        // Populate the table with data from the array
        for (let i = 1; i < tableData.length; i++) {
            const row = document.createElement('tr');

            // Add Bootstrap's 'd-none' class to initially hide rows 2 and 3
            if ((i === 2 || i === 3) && !rowsVisible) {
                row.classList.add('d-none');
            }
            if ((i === 2 || i === 3) && rowsVisible) {
                // Ensure rows will be visible if needed
                row.classList.remove('d-none');
            }

            for (let j = 0; j < tableData[i].length; j++) {
                const cell = document.createElement('td');
                cell.innerHTML = tableData[i][j];

                // Add click event listener to Row 1, Cell 1 to toggle visibility of Row 2 and Row 3
                if (i === 1 && j === 0) {
                    cell.onclick = function() { toggleRowsVisibility(); };
                }

                row.appendChild(cell);
            }
            tbody.appendChild(row);
        }

        // Update the toggle icon based on current visibility state
        const toggleIcon = document.getElementById('toggleIcon');
        if (rowsVisible) {
            toggleIcon.innerText = '-';
        } else {
            toggleIcon.innerText = '+';
        }
    }

    // Call this function to add a new column to the array and update the table
    function addColumnToArray() {
        // Add new column (cell) to each row in the array
        tableData[0].push(`Column ${tableData[0].length + 1}`);
        for (let i = 1; i < tableData.length; i++) {
            tableData[i].push(`Row ${i}, Cell ${tableData[i].length + 1}`);
        }

        // Repopulate the table while preserving the toggle state
        populateTableFromArray();
    }

    // Call this function to delete a column from the array and update the table
    function deleteColumn(index) {
        // Remove the specified column from each row in the array
        for (let i = 0; i < tableData.length; i++) {
            tableData[i].splice(index, 1);
        }

        // Repopulate the table
        populateTableFromArray();
    }

    // Call this function to toggle the visibility of rows 2 and 3
    function toggleRowsVisibility() {
        const table = document.getElementById('myTable');
        const rows = table.querySelectorAll('tbody tr');
        const toggleIcon = document.getElementById('toggleIcon');

        rows[1].classList.toggle('d-none'); // Row 2
        rows[2].classList.toggle('d-none'); // Row 3

        // Update the icon based on the visibility of rows 2 and 3
        if (rows[1].classList.contains('d-none') && rows[2].classList.contains('d-none')) {
            toggleIcon.innerText = '+';
            rowsVisible = false; // Update the visibility state
        } else {
            toggleIcon.innerText = '-';
            rowsVisible = true; // Update the visibility state
        }
    }

    // Populate the initial table data when the page loads
    populateTableFromArray();
</script>

</body>
</html>
